---
title: Generating a Sitemap with Next.js
description: This guide explains how to create a sitemap in Next.js to improve SEO and increase visibility, with getServerSideProps, readdirSync, and join used to generate sitemap XML content.
banner: /images/sitemap-nextjs/og.jpeg
date: 2023-02-12
tags: [react, sitemap, nextjs, seo]
alt: business, communication, computer
---

You should make sure that search engines can simply crawl and index your pages while creating a website. A sitemap, an XML file that lists every page on your website, is one approach to assist them in doing this. We'll examine how to create a sitemap in Next.js using the `getServerSideProps` method in this article.

## The Code

Here's the code we'll be discussing:

```jsx:pages/sitemap.xml.jsx
import { readdirSync } from 'fs';
import { join } from 'path';

const createSitemap = (slugs) => `<?xml version="1.0" encoding="UTF-8"?>
    <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
        ${slugs
          .map((slug) => {
            return `
                <url>
                    <loc>${`https://example.com/${slug}`}</loc>
                </url>
            `;
          })
          .join('')}
    </urlset>
`;

export async function getServerSideProps({ res }) {
  const allPosts = readdirSync(join(process.cwd(), 'content'));
  const allPages = [
    ...allPosts.map((slug) => `blog/${slug.replace('.mdx', '')}`),
    ...['', 'blog', 'about', 'contact']
  ];

  res.setHeader('Content-Type', 'text/xml');
  res.setHeader(
    'Cache-Control',
    'public, s-maxage=1200, stale-while-revalidate=600'
  );
  res.write(createSitemap(allPages));
  res.end();

  return {
    props: {}
  };
}

export default function Sitemap() {
  return null;
}
```

## Understanding the Code

Let's break down the code and see how it generates the sitemap.

### Importing dependencies

The code starts by importing the `readdirSync` and `join` functions from the `fs` and `path` modules, respectively. These functions will be used to read the contents of the `content` directory and join the file paths together.

### `createSitemap` function

The XML sitemap's content is generated by the `createSitemap` function using an array of slugs as its input. For each slug, a URL element is created using template literals by mapping over the slugs. The resulting XML is returned as a string.

### `getServerSideProps` function

The getServerSideProps function is a special function in Next.js that runs on the server when a page is requested. It takes an object with a res property, which is the server response object.

The function uses `readdirSync` to read the contents of the `content` directory and then converts the file names into an array of slugs by mapping them over and deleting the `.mdx` extension. The array of all website pages is created by combining these slugs with a set of hardcoded pages, including the homepage, blog page, about page, and contact page.

In order to optimize performance, the function also sets caching headers and sets the response headers to indicate that the response is an XML file. Using the `write` method, it adds the XML content to the response, and the `end` method closes the response.

The code finally returns an empty object for the `props` property, which Next.js requires.

### `Sitemap` component

The `Sitemap` component is only a placeholder with no functionality. Next.Js requests that you specify a page, however in this instance we don't need to display anything on the page, so we return `null`.

### Use the sitemap

The sitemap can be accessed at `/sitemap.xml` after this code has been added to your Next.js project. The XML content generated by the 'createSitemap' function should be shown as follows:

```xml
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  <url>
    <loc>https://example.com/</loc>
  </url>
  <url>
    <loc>https://example.com/blog/first-post</loc>
  </url>
  <url>
    <loc>https://example.com/blog/second-post</loc>
  </url>
  <url>
    <loc>https://example.com/blog/third-post</loc>
  </url>
  <url>
    <loc>https://example.com/about</loc>
  </url>
  <url>
    <loc>https://example.com/contact</loc>
  </url>
</urlset>
```

This XML file can then be submitted to search engines to help them crawl and index your pages.

## Conclusion

Using Next.Js to create a sitemap is essential for increasing SEO. To construct an array of slugs and generate the sitemap XML content, utilize the getServerSideProps function, readdirSync, and join. It's important to keep the sitemap up to date, and the code may need to be modified for certain website requirements. Generating a sitemap helps increaseÂ traffic and visibility in search engine.
